<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="David A. Selby" />


<title>Quasi-symmetry models with the scrooge package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Quasi-symmetry models with the <code>scrooge</code> package</h1>
<h4 class="author"><em>David A. Selby</em></h4>
<h4 class="date"><em>Wednesday 5 October 2016</em></h4>



<div id="preamble" class="section level2">
<h2>Preamble</h2>
<p>The <code>scrooge</code> package is a collection of utilities and functions for studying bibliometrics. Install it using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">'Selbosh/scrooge'</span>)</code></pre></div>
<p>Then load the package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scrooge)</code></pre></div>
</div>
<div id="introduction-to-quasi-symmetry" class="section level2">
<h2>Introduction to quasi-symmetry</h2>
<p>A square matrix <span class="math inline">\(Q\)</span> is quasi-symmetric if it can be decomposed in the form <span class="math inline">\(Q = AS\)</span>, where <span class="math inline">\(A\)</span> is diagonal and <span class="math inline">\(S\)</span> is symmetric. The function <code>rquasisymmetric</code> generates (sparse) quasi-symmetric matrices, with the elements of <span class="math inline">\(S\)</span> independently sampled from a Poisson distribution and the elements of <span class="math inline">\(A\)</span> (or the corresponding vector of diagonal elements, <span class="math inline">\(a\)</span>) sampled from a uniform distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">100</span>
Q &lt;-<span class="st"> </span><span class="kw">rquasisymmetric</span>(n, <span class="dt">density =</span> <span class="dv">1</span>)
D &lt;-<span class="st"> </span>Matrix::<span class="kw">Diagonal</span>(n, Matrix::<span class="kw">colSums</span>(Q))</code></pre></div>
<p>The symmetric and diagonal components are saved as attributes of the output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attr</span>(Q, <span class="st">'a'</span>)
<span class="kw">attr</span>(Q, <span class="st">'S'</span>)
<span class="co"># Output hidden</span></code></pre></div>
<p>The <code>Scroogefactor</code> function computes the leading eigenvector of <code>Q / colSums(Q)</code>. It is equivalent to <code>PageRank(Q, 1) / colSums(Q)</code>. Given a quasi-symmetric matrix, this should extract the vector <code>a</code> exactly. For identifiability, the vector <code>a</code> and the output of <code>Scroogefactor</code> should each sum to one.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SF &lt;-<span class="st"> </span><span class="kw">Scroogefactor</span>(Q)
PR &lt;-<span class="st"> </span><span class="kw">PageRank</span>(Q, <span class="dt">alpha =</span> <span class="dv">1</span>) /<span class="st"> </span>Matrix::<span class="kw">colSums</span>(Q)
PR &lt;-<span class="st"> </span>PR /<span class="st"> </span><span class="kw">sum</span>(PR) <span class="co"># Renormalise to sum to 1</span>
<span class="kw">all.equal</span>(SF, PR)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(SF, <span class="kw">attr</span>(Q, <span class="st">'a'</span>))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="the-bradleyterry-model" class="section level2">
<h2>The Bradley–Terry model</h2>
<p>The quasi-symmetry model is a representation of the Bradley–Terry model. The latter involves computing ‘ability weights’ of sports teams, chess players, academic journals or any other objects involved in paired comparisons. The abilities, estimated via maximum likelihood, are equivalent to the <span class="math inline">\(a\)</span> scaling vector in the quasi-symmetry model.</p>
<p>Another (not very rigorous) way of putting it might be to say that the <span class="math inline">\(S\)</span> matrix describes the “undirected” component of the graph (say, the absolute intensity of the connections) and <span class="math inline">\(A\)</span> describes the “directed” part (the relative ranking).</p>
</div>
<div id="damping-factors" class="section level2">
<h2>Damping factors</h2>
<p>So far we have chosen the argument <code>alpha = 1</code> in the <code>PageRank</code> function. This is equivalent to an <em>undamped</em> PageRank, where the probability of a random surfer teleporting during a traversal around the graph is zero. Damping can make the PageRank calculation more stable and help deal with disconnected or non-ergodic components of the network.</p>
<p>For <code>alpha</code> &lt; 1 in PageRank is there an equivalent adjustment that will retrieve exactly the same vector for the Bradley–Terry model?</p>
<p>Assuming quasi-symmetry, PageRank involves computing the leading eigenvector of</p>
<p><span class="math display">\[
\alpha Q D^{-1}   + (1-\alpha) \frac1n e e^T.
\]</span></p>
<p>We know that the <em>Scroogefactor</em>, defined as PageRank per out-link, retrieves the vector <span class="math inline">\(a\)</span> when <span class="math inline">\(Q\)</span> is quasi-symmetric and PageRank is undamped. This can be extended to deal with damping, as follows.</p>
<ol style="list-style-type: decimal">
<li>Let <span class="math inline">\(Q = AS\)</span> be quasi-symmetric. Let <span class="math inline">\(D\)</span> be the diagonal matrix of column sums of <span class="math inline">\(Q\)</span>.</li>
<li>Undamped PageRank, <span class="math inline">\(\pi_1\)</span>, is the leading (right) eigenvector of <span class="math inline">\(QD^{-1}\)</span>. Undamped Scroogefactor, <span class="math inline">\(D^{-1}\pi_1\)</span> is exactly equivalent to the diagonal component (Bradley–Terry scores) of <span class="math inline">\(Q = (Q D^{-1}) D\)</span>.</li>
<li>Damped PageRank, <span class="math inline">\(\pi_\alpha\)</span>, is the leading eigenvector of <span class="math display">\[\alpha Q D^{-1} + (1-\alpha)\frac1n e e^T\]</span> (where <span class="math inline">\(e\)</span> is an <span class="math inline">\(n\)</span>-vector of ones), so damped Scroogefactor, <span class="math inline">\(\text{SF}_\alpha = D^{-1}\pi_\alpha\)</span>, should be equivalent to the Bradley–Terry scores of <span class="math display">\[
Q_\alpha = \left[ \alpha Q D^{-1} + (1-\alpha)\frac1n e e^T \right] D = \alpha Q + (1-\alpha)\frac1n ee^T D.
\]</span></li>
</ol>
<p>So we test this out as follows. (Recall <code>ILSR</code> computes an approximate Bradley–Terry maximum likelihood estimate.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co"># in (0, 1)</span>
Q_pseudo &lt;-<span class="st"> </span>alpha *<span class="st"> </span>Q +<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>alpha) *<span class="st"> </span>Matrix::<span class="kw">Matrix</span>(<span class="dv">1</span>, n, n) %*%<span class="st"> </span>D /<span class="st"> </span>n
<span class="kw">plot</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q))
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q))</code></pre></div>
<pre><code>## [1] 0.999955</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q_pseudo))
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q_pseudo))</code></pre></div>
<pre><code>## [1] 0.9999987</code></pre>
</div>
<div id="symmetrizable-matrices" class="section level2">
<h2>Symmetrizable matrices</h2>
<p>A matrix <span class="math inline">\(Q\)</span> is symmetrizable if there exists an invertible diagonal matrix <span class="math inline">\(A\)</span> and a symmetric matrix <span class="math inline">\(S\)</span> such that <span class="math inline">\(X = AS\)</span>. Symmetrizability appears to be synonymous with quasi-symmetry. The diagonal matrix is called the symmetrizer matrix <span class="citation">(Dias, Castonguay, and Dourado 2015)</span>.</p>
<p>A matrix <span class="math inline">\(Q\)</span> is symmetrizable if and only if, for <span class="math inline">\(k\geq 3\)</span> and any finite sequence <span class="math inline">\((i_1, i_2, \dots, i_k)\)</span> it satisfies <span class="math display">\[q_{i_1 i_2} \cdot q_{i_2 i_3} \cdot \dots \cdot q_{i_k i_1} = q_{i_2 i_1} \cdot q_{i_3 i_2} \cdot \dots \cdot q_{i_1 i_k}.
\]</span></p>
<p>The following algorithm, proposed in <span class="citation">Dias, Castonguay, and Dourado (2015)</span>, determines whether a matrix is symmetrizable or not and, if so, returns the diagonal matrix <span class="math inline">\(A\)</span> in <span class="math inline">\(O(n^2)\)</span> time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SymmetrizableMatrix &lt;-<span class="st"> </span>function(Q) {
  <span class="kw">stopifnot</span>(<span class="kw">length</span>(<span class="kw">dim</span>(Q)) ==<span class="st"> </span><span class="dv">2</span> &amp;<span class="st"> </span>!<span class="kw">diff</span>(<span class="kw">dim</span>(Q)))
  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(Q)
  A &lt;-<span class="st"> </span>Matrix::<span class="kw">Diagonal</span>(n, <span class="dv">0</span>)
  TT &lt;-<span class="st"> </span><span class="dv">1</span>:n
  iter &lt;-<span class="st"> </span><span class="dv">0</span>
  while(<span class="kw">length</span>(TT) &gt;<span class="st"> </span><span class="dv">0</span>) {
    iter &lt;-<span class="st"> </span>iter +<span class="st"> </span><span class="dv">1</span>
    if (iter &gt;<span class="st"> </span>n^<span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">'Failed to halt'</span>)
    i &lt;-<span class="st"> </span>TT[<span class="dv">1</span>]
    TT &lt;-<span class="st"> </span>TT[-<span class="dv">1</span>]
    if (A[i, i] ==<span class="st"> </span><span class="dv">0</span>) A[i, i] &lt;-<span class="st"> </span><span class="dv">1</span>
    for (j in TT) {
      if (Q[i, j] *<span class="st"> </span>Q[j, i] ==<span class="st"> </span><span class="dv">0</span>) {
        if (Q[i, j] +<span class="st"> </span>Q[j, i] !=<span class="st"> </span><span class="dv">0</span>) {
          <span class="kw">return</span>(<span class="ot">FALSE</span>)
        }
      } else {
        TT &lt;-<span class="st"> </span><span class="kw">c</span>(j, TT[TT !=<span class="st"> </span>j]) <span class="co"># Move j to first position of T</span>
        if (A[j, j] !=<span class="st"> </span><span class="dv">0</span>) {
          if ((A[i, i] *<span class="st"> </span>Q[i, j]) !=<span class="st"> </span>(A[j, j] *<span class="st"> </span>Q[j, i])) {
            <span class="kw">return</span>(<span class="ot">FALSE</span>)
          }
        } else A[j, j] &lt;-<span class="st"> </span>(A[i, i] *<span class="st"> </span>Q[i, j]) /<span class="st"> </span>Q[j, i]
      }
    }
  }
  <span class="kw">message</span>(<span class="st">'Matrix is symmetrizable. Returning symmetrizer matrix...'</span>)
  <span class="kw">return</span>(A)
}</code></pre></div>
<p>Test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S &lt;-<span class="st"> </span><span class="kw">attr</span>(<span class="kw">rquasisymmetric</span>(<span class="dv">5</span>, <span class="dt">dens =</span> <span class="dv">1</span>), <span class="st">'S'</span>)
A &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">5</span>, <span class="ot">TRUE</span>))
Q &lt;-<span class="st"> </span>A %*%<span class="st"> </span>S
<span class="kw">SymmetrizableMatrix</span>(Q)</code></pre></div>
<pre><code>## Matrix is symmetrizable. Returning symmetrizer matrix...</code></pre>
<pre><code>## 5 x 5 diagonal matrix of class &quot;ddiMatrix&quot;
##      [,1] [,2] [,3]     [,4] [,5]
## [1,]    1    .        .    .    .
## [2,]    .    2        .    .    .
## [3,]    .    . 1.333333    .    .
## [4,]    .    .        .  1.6    .
## [5,]    .    .        .    .  0.8</code></pre>
<p>And the <strong>true</strong> <span class="math inline">\(A^{-1}\)</span> was:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">solve</span>(A)</code></pre></div>
<pre><code>##       [,1] [,2]      [,3] [,4] [,5]
## [1,] 0.125 0.00 0.0000000  0.0  0.0
## [2,] 0.000 0.25 0.0000000  0.0  0.0
## [3,] 0.000 0.00 0.1666667  0.0  0.0
## [4,] 0.000 0.00 0.0000000  0.2  0.0
## [5,] 0.000 0.00 0.0000000  0.0  0.1</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Dias2015">
<p>Dias, Elisângela Silva, Diane Castonguay, and Mitre Costa Dourado. 2015. “Algorithms and Properties for Positive Symmetrizable Matrices.” <em>ArXiv:1503.03468v1 [Cs.DM]</em>. <a href="https://arxiv.org/pdf/1503.03468v1.pdf" class="uri">https://arxiv.org/pdf/1503.03468v1.pdf</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
