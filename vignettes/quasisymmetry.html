<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="David A. Selby" />


<title>Quasi-symmetry models with the scrooge package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Quasi-symmetry models with the <code>scrooge</code> package</h1>
<h4 class="author"><em>David A. Selby</em></h4>
<h4 class="date"><em>Tuesday 11 October 2016</em></h4>



<div id="preamble" class="section level2">
<h2>Preamble</h2>
<p>The <code>scrooge</code> package is a collection of utilities and functions for studying bibliometrics. Install it using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">'Selbosh/scrooge'</span>)</code></pre></div>
<p>Then load the package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scrooge)</code></pre></div>
</div>
<div id="introduction-to-quasi-symmetry" class="section level2">
<h2>Introduction to quasi-symmetry</h2>
<p>A square matrix <span class="math inline">\(Q\)</span> is quasi-symmetric if it can be decomposed in the form <span class="math inline">\(Q = AS\)</span>, where <span class="math inline">\(A\)</span> is diagonal and <span class="math inline">\(S\)</span> is symmetric. The function <code>rquasisymmetric</code> generates (sparse) quasi-symmetric matrices, with the elements of <span class="math inline">\(S\)</span> independently sampled from a Poisson distribution and the elements of <span class="math inline">\(A\)</span> (or the corresponding vector of diagonal elements, <span class="math inline">\(a\)</span>) sampled from a uniform distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">100</span>
Q &lt;-<span class="st"> </span><span class="kw">rquasisymmetric</span>(n)
D &lt;-<span class="st"> </span>Matrix::<span class="kw">Diagonal</span>(n, Matrix::<span class="kw">colSums</span>(Q))</code></pre></div>
<p>The symmetric and diagonal components are saved as attributes of the output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attr</span>(Q, <span class="st">'a'</span>)
<span class="kw">attr</span>(Q, <span class="st">'S'</span>)
<span class="co"># Output hidden</span></code></pre></div>
<p>The <code>Scroogefactor</code> function computes the leading eigenvector of <code>Q / colSums(Q)</code>. It is equivalent to <code>PageRank(Q, 1) / colSums(Q)</code>. Given a quasi-symmetric matrix, this should extract the vector <code>a</code> exactly. For identifiability, the vector <code>a</code> and the output of <code>Scroogefactor</code> should each sum to one.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SF &lt;-<span class="st"> </span><span class="kw">Scroogefactor</span>(Q)
PR &lt;-<span class="st"> </span><span class="kw">PageRank</span>(Q, <span class="dt">alpha =</span> <span class="dv">1</span>) /<span class="st"> </span>Matrix::<span class="kw">colSums</span>(Q)
PR &lt;-<span class="st"> </span>PR /<span class="st"> </span><span class="kw">sum</span>(PR) <span class="co"># Renormalise to sum to 1</span>
<span class="kw">all.equal</span>(SF, PR)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(SF, <span class="kw">attr</span>(Q, <span class="st">'a'</span>))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="the-bradleyterry-model" class="section level2">
<h2>The Bradley–Terry model</h2>
<p>The quasi-symmetry model is a representation of the Bradley–Terry model. The latter involves computing ‘ability weights’ of sports teams, chess players, academic journals or any other objects involved in paired comparisons. The abilities, estimated via maximum likelihood, are equivalent to the <span class="math inline">\(a\)</span> scaling vector in the quasi-symmetry model.</p>
<p>Another (not very rigorous) way of putting it might be to say that the <span class="math inline">\(S\)</span> matrix describes the “undirected” component of the graph (say, the absolute intensity of the connections) and <span class="math inline">\(A\)</span> describes the “directed” part (the relative ranking).</p>
</div>
<div id="damping-factors" class="section level2">
<h2>Damping factors</h2>
<p>So far we have chosen the argument <code>alpha = 1</code> in the <code>PageRank</code> function. This is equivalent to an <em>undamped</em> PageRank, where the probability of a random surfer teleporting during a traversal around the graph is zero. Damping can make the PageRank calculation more stable and help deal with disconnected or non-ergodic components of the network.</p>
<p>For <code>alpha</code> &lt; 1 in PageRank is there an equivalent adjustment that will retrieve exactly the same vector for the Bradley–Terry model?</p>
<p>PageRank involves computing the leading eigenvector of the “Google matrix”,</p>
<p><span class="math display">\[
G := \alpha Q D^{-1}   + (1-\alpha) \frac1n e e^T.
\]</span></p>
<p>We know that the <em>Scroogefactor</em>, defined as PageRank per out-link, retrieves the vector <span class="math inline">\(a\)</span> when <span class="math inline">\(Q\)</span> is quasi-symmetric and PageRank is undamped. This can be extended to deal with damping, as follows.</p>
<ol style="list-style-type: decimal">
<li>Let <span class="math inline">\(Q = AS\)</span> be quasi-symmetric. Let <span class="math inline">\(D\)</span> be the diagonal matrix of column sums of <span class="math inline">\(Q\)</span>.</li>
<li>Undamped PageRank, <span class="math inline">\(\pi_1\)</span>, is the leading (right) eigenvector of <span class="math inline">\(QD^{-1}\)</span>. Undamped Scroogefactor, <span class="math inline">\(D^{-1}\pi_1\)</span> is exactly equivalent to the diagonal component (Bradley–Terry scores) of <span class="math inline">\(Q = (Q D^{-1}) D\)</span>.</li>
<li>Damped PageRank, <span class="math inline">\(\pi_\alpha\)</span>, is the leading eigenvector of <span class="math display">\[\alpha Q D^{-1} + (1-\alpha)\frac1n e e^T\]</span> (where <span class="math inline">\(e\)</span> is an <span class="math inline">\(n\)</span>-vector of ones), so damped Scroogefactor, <span class="math inline">\(\text{SF}_\alpha = D^{-1}\pi_\alpha\)</span>, should be equivalent to the Bradley–Terry scores of <span class="math display">\[
Q_\alpha = \left[ \alpha Q D^{-1} + (1-\alpha)\frac1n e e^T \right] D = \alpha Q + (1-\alpha)\frac1n ee^T D.
\]</span></li>
</ol>
<p>So we test this out as follows. (Recall <code>ILSR</code> computes an approximate Bradley–Terry maximum likelihood estimate.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co"># in (0, 1)</span>
Q_pseudo &lt;-<span class="st"> </span>alpha *<span class="st"> </span>Q +<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>alpha) *<span class="st"> </span>Matrix::<span class="kw">Matrix</span>(<span class="dv">1</span>, n, n) %*%<span class="st"> </span>D /<span class="st"> </span>n
<span class="kw">plot</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q))
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q))</code></pre></div>
<pre><code>## [1] 0.9993324</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q_pseudo))
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(<span class="kw">Scroogefactor</span>(Q, alpha), <span class="kw">ILSR</span>(Q_pseudo))</code></pre></div>
<pre><code>## [1] 0.9999933</code></pre>
<p>By matrix similarity, damped Scroogefactor <span class="math inline">\(D^{-1}\pi_\alpha\)</span> is equivalent to calculating the leading eigenvector of <span class="math display">\[\widetilde{G} := \alpha D^{-1} Q + (1 - \alpha) \frac1n D^{-1} ee^T D.\]</span> It is easy to see that <span class="math inline">\(G\)</span> and <span class="math inline">\(\widetilde{G}\)</span> are similar: <span class="math inline">\(\widetilde{G} = D^{-1} G D\)</span> and so <span class="math inline">\(G = D \widetilde{G} D^{-1}\)</span>.</p>
</div>
<div id="proving-the-relationship-between-quasi-symmetry-and-eigenvector-centrality" class="section level2">
<h2>Proving the relationship between quasi-symmetry and eigenvector centrality</h2>
<p>In the undamped case, it is easy to show that Scroogefactor (i.e. scaled PageRank) retrieves the true diagonal component of a quasi-symmetric matrix. We know that <span class="math inline">\(D^{-1} Q\)</span> and <span class="math inline">\(Q D^{-1}\)</span> are similar, and <span class="math inline">\(Q D^{-1}\)</span> is column-stochastic so its largest eigenvalue is 1, which means the largest eigenvalue of <span class="math inline">\(D^{-1}Q\)</span> is also 1.</p>
<p>Here we show that the diagonal component of <span class="math inline">\(Q\)</span>, represented by the vector <span class="math inline">\(Ae = \mu\)</span> is equal to the leading eigenvector of <span class="math inline">\(D^{-1} Q\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
D^{-1}Q \mu
&amp;= D^{-1} A S A e \\
&amp;= D^{-1} A (e^T A S)^T \\
&amp;= A D^{-1} D e \\
&amp;= Ae \\
&amp;= \mu.
\end{aligned}\]</span></p>
<p>In other words, the Scroogefactor (eigenvector) retrieves <span class="math inline">\(A\)</span> exactly in the undamped quasi-symmetric case.</p>
<p>What about the damped case? We want to show that the Bradley–Terry parameter vector (diagonal component) of <span class="math inline">\(\alpha Q + (1-\alpha)\frac1n ee^T D\)</span> is the leading eigenvector of <span class="math inline">\(\widetilde{G}\)</span>.</p>
<p>However, it is not immediately clear how to write this vector down in closed form (whereas in the undamped case it was simply <span class="math inline">\(\mu:=Ae\)</span>). Is <span class="math inline">\(GD\)</span> quasi-symmetric? If so, we could simply substitute <span class="math inline">\(GD\)</span> for <span class="math inline">\(Q\)</span> in the equations above and the result would follow.</p>
<p>In general, the sum of two quasi-symmetric matrices is not quasi-symmetric.</p>
<p>We have <span class="math display">\[\begin{aligned}
GD &amp;= \alpha Q + (1-\alpha)\frac1n ee^T D \\
&amp;= \alpha Q + (1-\alpha)\frac1n ee^T \operatorname{diag}(e^TQ) \\
&amp;= \alpha Q + (1-\alpha)\frac1n ee^T Q \\
&amp;= \left[\alpha I + (1-\alpha)\frac1n ee^T \right] Q
\end{aligned}\]</span></p>
<p>where the operator in the square brackets is symmetric, doubly stochastic and diagonally dominant.</p>
<p>Perhaps there is a more general type of matrices, not necessarily quasi-symmetric to which this relation belongs.</p>
</div>
<div id="symmetrizable-matrices" class="section level2">
<h2>Symmetrizable matrices</h2>
<p>A matrix <span class="math inline">\(Q\)</span> is symmetrizable if there exists an invertible diagonal matrix <span class="math inline">\(A\)</span> and a symmetric matrix <span class="math inline">\(S\)</span> such that <span class="math inline">\(X = AS\)</span>. Symmetrizability appears to be synonymous with quasi-symmetry. The diagonal matrix is called the symmetrizer matrix <span class="citation">(Dias, Castonguay, and Dourado 2015)</span>.</p>
<p>A matrix <span class="math inline">\(Q\)</span> is symmetrizable if and only if, for <span class="math inline">\(k\geq 3\)</span> and any finite sequence <span class="math inline">\((i_1, i_2, \dots, i_k)\)</span> it satisfies <span class="math display">\[q_{i_1 i_2} \cdot q_{i_2 i_3} \cdot \dots \cdot q_{i_k i_1} = q_{i_2 i_1} \cdot q_{i_3 i_2} \cdot \dots \cdot q_{i_1 i_k}.
\]</span></p>
<p>The following algorithm, proposed in <span class="citation">Dias, Castonguay, and Dourado (2015)</span>, determines whether a matrix is symmetrizable or not and, if so, returns the diagonal matrix <span class="math inline">\(A\)</span> in <span class="math inline">\(O(n^2)\)</span> time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SymmetrizableMatrix &lt;-<span class="st"> </span>function(Q) {
  <span class="kw">stopifnot</span>(<span class="kw">length</span>(<span class="kw">dim</span>(Q)) ==<span class="st"> </span><span class="dv">2</span> &amp;<span class="st"> </span>!<span class="kw">diff</span>(<span class="kw">dim</span>(Q)))
  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(Q)
  A &lt;-<span class="st"> </span>Matrix::<span class="kw">Diagonal</span>(n, <span class="dv">0</span>)
  TT &lt;-<span class="st"> </span><span class="dv">1</span>:n
  iter &lt;-<span class="st"> </span><span class="dv">0</span>
  while(<span class="kw">length</span>(TT) &gt;<span class="st"> </span><span class="dv">0</span>) {
    iter &lt;-<span class="st"> </span>iter +<span class="st"> </span><span class="dv">1</span>
    if (iter &gt;<span class="st"> </span>n^<span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">'Failed to halt'</span>)
    i &lt;-<span class="st"> </span>TT[<span class="dv">1</span>]
    TT &lt;-<span class="st"> </span>TT[-<span class="dv">1</span>]
    if (A[i, i] ==<span class="st"> </span><span class="dv">0</span>) A[i, i] &lt;-<span class="st"> </span><span class="dv">1</span>
    for (j in TT) {
      if (Q[i, j] *<span class="st"> </span>Q[j, i] ==<span class="st"> </span><span class="dv">0</span>) {
        if (Q[i, j] +<span class="st"> </span>Q[j, i] !=<span class="st"> </span><span class="dv">0</span>) {
          <span class="kw">return</span>(<span class="ot">FALSE</span>)
        }
      } else {
        TT &lt;-<span class="st"> </span><span class="kw">c</span>(j, TT[TT !=<span class="st"> </span>j]) <span class="co"># Move j to first position of T</span>
        if (A[j, j] !=<span class="st"> </span><span class="dv">0</span>) {
          if ((A[i, i] *<span class="st"> </span>Q[i, j]) !=<span class="st"> </span>(A[j, j] *<span class="st"> </span>Q[j, i])) {
            <span class="kw">return</span>(<span class="ot">FALSE</span>)
          }
        } else A[j, j] &lt;-<span class="st"> </span>(A[i, i] *<span class="st"> </span>Q[i, j]) /<span class="st"> </span>Q[j, i]
      }
    }
  }
  <span class="kw">message</span>(<span class="st">'Matrix is symmetrizable. Returning symmetrizer matrix...'</span>)
  <span class="kw">return</span>(A)
}</code></pre></div>
<p>Test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S &lt;-<span class="st"> </span><span class="kw">attr</span>(<span class="kw">rquasisymmetric</span>(<span class="dv">5</span>), <span class="st">'S'</span>)
A &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">5</span>, <span class="ot">TRUE</span>))
Q &lt;-<span class="st"> </span>A %*%<span class="st"> </span>S
<span class="kw">SymmetrizableMatrix</span>(Q)</code></pre></div>
<pre><code>## Matrix is symmetrizable. Returning symmetrizer matrix...</code></pre>
<pre><code>## 5 x 5 diagonal matrix of class &quot;ddiMatrix&quot;
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    .    .    .    .
## [2,]    .  1.5    .    .    .
## [3,]    .    .  0.6    .    .
## [4,]    .    .    .    3    .
## [5,]    .    .    .    .    6</code></pre>
<p>And the <strong>true</strong> <span class="math inline">\(A^{-1}\)</span> was:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">solve</span>(A)</code></pre></div>
<pre><code>##           [,1] [,2] [,3] [,4] [,5]
## [1,] 0.1666667 0.00  0.0  0.0    0
## [2,] 0.0000000 0.25  0.0  0.0    0
## [3,] 0.0000000 0.00  0.1  0.0    0
## [4,] 0.0000000 0.00  0.0  0.5    0
## [5,] 0.0000000 0.00  0.0  0.0    1</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Dias2015">
<p>Dias, Elisângela Silva, Diane Castonguay, and Mitre Costa Dourado. 2015. “Algorithms and Properties for Positive Symmetrizable Matrices.” <em>ArXiv:1503.03468v1 [Cs.DM]</em>. <a href="https://arxiv.org/pdf/1503.03468v1.pdf" class="uri">https://arxiv.org/pdf/1503.03468v1.pdf</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
